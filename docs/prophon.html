<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Projected Phonons &mdash; ThermoParser 3.0.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Average Rates" href="avg-rates.html" />
    <link rel="prev" title="Waterfall" href="waterfalls.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="contents.html" class="icon icon-home"> ThermoParser<img src="_static/tp-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="gallery.html">Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="heatmaps.html">Heatmaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="phonons.html">Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="dos.html">Density of States (DoS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cumkappa.html">Cumulative Kappa</a></li>
<li class="toctree-l2"><a class="reference internal" href="waterfalls.html">Waterfalls</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Projected Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="avg-rates.html">Average Scattering Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery.html#note">Note:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#command-line-interface-cli">Command Line Interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#python-interface">Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#contributing">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Python API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">ThermoParser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="gallery.html">Gallery</a> &raquo;</li>
      <li>Projected Phonons</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/prophon.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="projected-phonons">
<h1>Projected Phonons<a class="headerlink" href="#projected-phonons" title="Permalink to this headline">Â¶</a></h1>
<img alt="Phonon dispersion with broadened bands." src="_images/wideband1.png" />
<p>This shows a phonon dispersion with bands broadened to indicate
scattering (the widest bands scatter the most). Via the command-line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tp plot wideband ../data/zno/band.yaml ../data/zno/kappa-m404021.hdf5 -c black -c red -s dark_background -p POSCAR
</pre></div>
</div>
<p>and in python:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">import</span> <span class="nn">tp</span>

<span class="n">phile</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/band.yaml&#39;</span>
<span class="n">kappafile</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/kappa-m404021.hdf5&#39;</span>
<span class="n">poscar</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/POSCAR&#39;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kappafile</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">kappafile</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;File not found, please use get-data.sh in the folder above.&#39;</span><span class="p">)</span>

<span class="n">colour</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff0000&#39;</span><span class="p">]</span>

<span class="c1"># running this section as a function is particularly important for mac users</span>
<span class="hll"><span class="c1"># due to its use of multiprocessing (this is the case for all projected phonon</span>
</span><span class="c1"># plots including alt_phonons and wideband)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="hll">    <span class="c1"># Axes</span>
</span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">add_legend</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">large</span><span class="o">.</span><span class="n">one</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">)</span>
    
    <span class="c1"># Load</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">phono3py</span><span class="p">(</span><span class="n">kappafile</span><span class="p">,</span> <span class="n">quantities</span><span class="o">=</span><span class="s1">&#39;wideband&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">pdata</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">phonopy_dispersion</span><span class="p">(</span><span class="n">phile</span><span class="p">)</span>
</span>    
    <span class="c1"># Add</span>
    <span class="n">tp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">phonons</span><span class="o">.</span><span class="n">add_wideband</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                                 <span class="n">colour</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> <span class="n">poscar</span><span class="o">=</span><span class="n">poscar</span><span class="p">)</span>
    
    <span class="c1"># Save</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wideband.pdf&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wideband.png&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>This also demonstrates the custom colourmaps which can be generated by
supplying a single hex, rgb (array) or named colour as the colour
input, or in this case two (the default background is normally white,
but to match the <code class="docutils literal notranslate"><span class="pre">dark_background</span></code> style sheet, black has been used
here). In this case, <code class="docutils literal notranslate"><span class="pre">tp.plot.colour.linear</span></code> has been used. It also
shows the large style, more suitable to presentations or posters than
the default one which is more suited to papers. Instead of the actual
quantities you want to load, <code class="docutils literal notranslate"><span class="pre">wideband</span></code> can select all necessary for
this plot.</p>
<img alt="Phonon dispersion with phonon lifetime projected." src="_images/prophon1.png" />
<p>This shows a phonon dispersion with phonon lifetime projected on the
colour axis. It is a more quantitative version of the above wideband
plot. It can be plotted in python with:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">import</span> <span class="nn">tp</span>

<span class="n">pfile</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/band.yaml&#39;</span>
<span class="n">kfile</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/kappa-m404021.hdf5&#39;</span>
<span class="n">poscar</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/POSCAR&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kfile</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">kfile</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;File not found, please use get-data.sh in the folder above.&#39;</span><span class="p">)</span>

<span class="n">projected</span> <span class="o">=</span> <span class="s1">&#39;lifetime&#39;</span>
<span class="n">quantities</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">projected</span><span class="p">,</span> <span class="s1">&#39;dispersion&#39;</span><span class="p">]</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">colour</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span>

<span class="c1"># running this section as a function is particularly important for mac users</span>
<span class="c1"># due to its use of multiprocessing (this is the case for all projected phonon</span>
<span class="c1"># plots including alt_phonons and wideband)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Axes</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">add_legend</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">small</span><span class="o">.</span><span class="n">one_colourbar</span><span class="p">()</span>
    
    <span class="c1"># Load</span>
<span class="hll">    <span class="n">data</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">phono3py</span><span class="p">(</span><span class="n">kfile</span><span class="p">,</span> <span class="n">quantities</span><span class="o">=</span><span class="n">quantities</span><span class="p">)</span>
</span><span class="hll">    <span class="n">pdata</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">phonopy_dispersion</span><span class="p">(</span><span class="n">pfile</span><span class="p">)</span>
</span><span class="hll">    
</span>    <span class="c1"># Add</span>
    <span class="n">tp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">phonons</span><span class="o">.</span><span class="n">add_projected_dispersion</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">projected</span><span class="p">,</span>
                                             <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                                             <span class="n">colour</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> <span class="n">poscar</span><span class="o">=</span><span class="n">poscar</span><span class="p">)</span>
    
    <span class="c1"># Save</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;prophon.pdf&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;prophon.png&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Another similar function is <code class="docutils literal notranslate"><span class="pre">tp.plot.phonons.add_alt_dispersion</span></code>,
which plots other phonon properties onto the y-axis along the high-
symmetry path provided by Phonopy. This will work with Phono3py
data, but also Gruneisen data from Phonopy
(<code class="docutils literal notranslate"><span class="pre">tp.data.load.phonopy_gruneisen</span></code>). Some useful tags for making the
Gruneisen data clearer include <code class="docutils literal notranslate"><span class="pre">scatter=True</span></code> (to clean up the bits
around &amp;Gamma;), <code class="docutils literal notranslate"><span class="pre">bandmax=3</span></code> (only acoustic phonons) and manually
setting the y-limit (some outliers are automatically hidden, but
especially if only the acoustic modes are shown, it can be useful to
cut some of the data off the top).</p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="waterfalls.html" class="btn btn-neutral float-left" title="Waterfall" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="avg-rates.html" class="btn btn-neutral float-right" title="Average Rates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Scanlon Materials Theory Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>