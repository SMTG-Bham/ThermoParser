<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cumulative Lattice Thermal Conductivity &mdash; ThermoParser 3.0.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Waterfall" href="waterfalls.html" />
    <link rel="prev" title="Density of States (DoS)" href="dos.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="contents.html" class="icon icon-home"> ThermoParser<img src="_static/tp-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="gallery.html">Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="heatmaps.html">Heatmaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="phonons.html">Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="dos.html">Density of States (DoS)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cumulative Kappa</a></li>
<li class="toctree-l2"><a class="reference internal" href="waterfalls.html">Waterfalls</a></li>
<li class="toctree-l2"><a class="reference internal" href="prophon.html">Projected Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="avg-rates.html">Average Scattering Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#command-line-interface-cli">Command Line Interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#python-interface">Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#contributing">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Python Package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">ThermoParser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="gallery.html">Gallery</a> &raquo;</li>
      <li>Cumulative Lattice Thermal Conductivity</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cumkappa.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="cumulative-lattice-thermal-conductivity">
<h1>Cumulative Lattice Thermal Conductivity<a class="headerlink" href="#cumulative-lattice-thermal-conductivity" title="Permalink to this headline">Â¶</a></h1>
<img alt="Cumulative lattice thermal conductivity against frequency and mean free path." src="_images/cumkappa1.png" />
<p>This shows two plots of cumulative lattice thermal conductivity. The
first one is against frequency, and particularly in conjunction with a
<a class="reference external" href="https://github.com/SMTG-UCL/ThermoParser/blob/master/examples/dos/">density of states</a> (DoS) or a phonon band structure, this can show the
relative contributions of the constituent atoms to the lattice thermal
conductivity. The second is against mean free path, and can be used to
approximate the effect of nanostructuring, for which reason the ability
to add markers has been included, e.g. here you can see nanostructuring
to 100 nanometers may reduce the lattice thermal conductivity by around
40 %.</p>
<p>The right plot can be plotted at the command line with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tp</span> <span class="n">plot</span> <span class="n">cumkappa</span> <span class="o">../</span><span class="n">data</span><span class="o">/</span><span class="n">zno</span><span class="o">/</span><span class="n">kappa</span><span class="o">-</span><span class="n">m404021</span><span class="o">.</span><span class="n">hdf5</span> <span class="o">--</span><span class="n">mfp</span> <span class="o">--</span><span class="n">percent</span> <span class="o">-</span><span class="n">d</span> <span class="n">x</span> <span class="o">-</span><span class="n">d</span> <span class="n">y</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;#59c605&#39;</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;#ffcf06&#39;</span> <span class="o">--</span><span class="n">nofill</span> <span class="o">--</span><span class="n">xmarkers</span> <span class="mf">1e-7</span> <span class="o">-</span><span class="n">l</span> <span class="n">x</span> <span class="o">-</span><span class="n">l</span> <span class="n">y</span> <span class="o">--</span><span class="n">location</span> <span class="ow">in</span>
</pre></div>
</div>
<p>And while the layering of the DoS plot is not yet supported at the
command line, the cumkappa part of the left graph can be plotted by
removing <code class="docutils literal notranslate"><span class="pre">--mfp</span> <span class="pre">--percent</span> <span class="pre">--xmarkers</span> <span class="pre">1e-7</span></code> from the above.</p>
<p>The python version is as follows:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">tp</span>

<span class="n">kappafile</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/kappa-m404021.hdf5&#39;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
<span class="n">quantities</span> <span class="o">=</span> <span class="s1">&#39;frequency mode_kappa mfp&#39;</span>
<span class="c1"># Note for cumkappa and waterfall plots, mode_kappa and not kappa is required</span>

<span class="c1"># You can ignore this section</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kappafile</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">kappafile</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;File not found, please use get-data.sh&#39;</span><span class="p">)</span>
<span class="c1"># End ignore</span>

<span class="n">dosfile</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/projected_dos.dat&#39;</span>
<span class="n">poscar</span> <span class="o">=</span> <span class="s1">&#39;../data/zno/POSCAR&#39;</span>

<span class="n">colour</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#59c605&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffcf06&#39;</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Zn&#39;</span><span class="p">:</span> <span class="s1">&#39;#d46ef9&#39;</span><span class="p">,</span>
           <span class="s1">&#39;O&#39;</span><span class="p">:</span>  <span class="s1">&#39;#7b8eff&#39;</span><span class="p">}</span>
<span class="c1"># Axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">add_legend</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">small</span><span class="o">.</span><span class="n">two_h</span><span class="p">()</span>

<span class="c1"># Load</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">phono3py</span><span class="p">(</span><span class="n">kappafile</span><span class="p">,</span> <span class="n">quantities</span><span class="o">=</span><span class="n">quantities</span><span class="p">)</span>
<span class="n">dos</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">phonopy_dos</span><span class="p">(</span><span class="n">dosfile</span><span class="p">,</span> <span class="n">poscar</span><span class="o">=</span><span class="n">poscar</span><span class="p">)</span>

<span class="c1"># Add</span>
<span class="n">tp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">add_cum_kappa</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                                <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="n">colour</span><span class="p">)</span>
<span class="hll"><span class="n">tp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mfp</span><span class="o">.</span><span class="n">add_cum_kappa</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span class="hll">                          <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> <span class="n">xmarkers</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">)</span>
</span><span class="hll"><span class="n">tp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">frequency</span><span class="o">.</span><span class="n">add_dos</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dos</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="n">colours</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span>
<span class="hll"><span class="n">add_legend</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span>
<span class="c1"># Save</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cumkappa.pdf&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cumkappa.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>In order to combine frequency plots, there are two important tags, <code class="docutils literal notranslate"><span class="pre">main</span></code>,
which controls the setting of axis limits and labels, and shouls be <code class="docutils literal notranslate"><span class="pre">False</span></code>
for all but the main plot; and <code class="docutils literal notranslate"><span class="pre">scale</span></code>, which scales the data to the axes,
allowing diverse plots to share :rainbow: (line 35). An alternative usage of
these is if both are <code class="docutils literal notranslate"><span class="pre">True</span></code>, it scales to percent (line 33). This is done
with the <code class="docutils literal notranslate"><span class="pre">--percent</span></code> tag at the command line.</p>
<p>The markers are added with the <code class="docutils literal notranslate"><span class="pre">xmarkers</span></code> tag (line 34), and have a
counterpart, <code class="docutils literal notranslate"><span class="pre">ymarkers</span></code>.</p>
<p>This also demonstrates use of the <code class="docutils literal notranslate"><span class="pre">add_legend</span></code> function supplied with
<code class="docutils literal notranslate"><span class="pre">tp.axes</span></code> functions (line 37), which combines the legends of all plots and
places itself in one of several pre-programmed position, which you can
select with the <code class="docutils literal notranslate"><span class="pre">location</span></code> argument. Numbers will place the legend
in one of the axes with <code class="docutils literal notranslate"><span class="pre">loc='best'</span></code>, and there are also several
descriptive positions, such as <code class="docutils literal notranslate"><span class="pre">above</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code>. It also accepts
most <code class="docutils literal notranslate"><span class="pre">ax.legend</span></code> arguements such as <code class="docutils literal notranslate"><span class="pre">title</span></code> and <code class="docutils literal notranslate"><span class="pre">ncol</span></code>. If you
want to use custom handles and labels in a multi-axes figure (including
DoS axes), you must specify <code class="docutils literal notranslate"><span class="pre">custom=True</span></code>.</p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dos.html" class="btn btn-neutral float-left" title="Density of States (DoS)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="waterfalls.html" class="btn btn-neutral float-right" title="Waterfall" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Scanlon Materials Theory Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>